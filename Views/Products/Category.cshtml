@model Web_Beta_ver2.Models.ProductFilterViewModel

@{
    ViewBag.Title = "Điện thoại thông minh";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/css/product-filter.css" rel="stylesheet" />

<div class="products-container">
    <!-- Filter & Sort Section -->
    <div class="filter-section">
        <div class="filter-header">
            <h2><i class="fas fa-mobile-alt"></i> @(Model.CategoryName ?? "Sản phẩm")</h2>
            <div class="product-count">
                <span id="product-count">Hiển thị @Model.Products.Count sản phẩm</span>
            </div>
        </div>

        <div class="sort-options">
            <button class="sort-btn @(Model.CurrentSort == "featured" ? "active" : "")"
                    data-sort="featured">
                <i class="fas fa-fire"></i> Nổi bật
            </button>
            <button class="sort-btn @(Model.CurrentSort == "bestseller" ? "active" : "")"
                    data-sort="bestseller">
                <i class="fas fa-crown"></i> Bán chạy
            </button>
            <button class="sort-btn @(Model.CurrentSort == "discount" ? "active" : "")"
                    data-sort="discount">
                <i class="fas fa-tags"></i> Giảm giá
            </button>
            <button class="sort-btn @(Model.CurrentSort == "new" ? "active" : "")"
                    data-sort="new">
                <i class="fas fa-star"></i> Mới nhất
            </button>
            <div class="price-sort-dropdown">
                <button class="sort-btn dropdown-toggle @(Model.CurrentSort.Contains("price") ? "active" : "")"
                        id="priceDropdown">
                    <i class="fas fa-sort-amount-down"></i> Giá
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="dropdown-menu" id="priceDropdownMenu">
                    <button class="dropdown-item" data-sort="price-asc">
                        <i class="fas fa-arrow-up"></i> Thấp đến cao
                    </button>
                    <button class="dropdown-item" data-sort="price-desc">
                        <i class="fas fa-arrow-down"></i> Cao đến thấp
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Grid -->
    <div class="product-grid" id="productGrid" data-type-id="@Model.TypeProductId">
        @foreach (var product in Model.Products)
        {
            <div class="product-card">
                @if (product.is_new)
                {
                    <div class="product-badge badge-new">Mới</div>
                }
                @if (product.DiscountPercent > 0)
                {
                    <div class="product-badge badge-discount">-@product.DiscountPercent%</div>
                }

                <img src="~/Content/Pic/images/@product.images"
                     alt="@product.product_name"
                     class="product-image">

                <div class="product-content">
                    <h3 class="product-name">@product.product_name</h3>

                    <div class="product-price-section">
                        <div class="product-price">@product.sale_price.ToString("N0") ₫</div>
                        @if (product.original_price > product.sale_price)
                        {
                            <div class="product-original-price">@product.original_price.ToString("N0") ₫</div>
                        }
                    </div>

                    <div class="product-description">
                        <ul>
                            @foreach (var point in product.product_description)
                            {
                                <li>@point</li>
                            }
                        </ul>
                    </div>

                    <div class="product-actions">
                        <button class="btn btn-add-cart" data-product-id="@product.product_id">
                            <i class="fas fa-cart-plus"></i> Thêm giỏ hàng
                        </button>
                        <button class="btn btn-buy-now"
                                data-product-id="@product.product_id"
                                title="Mua ngay">
                            <i class="fas fa-bolt"></i>
                        </button>
                    </div>
                </div>
            </div>
        }
    </div>

    <!-- Load More Button -->
    @if (Model.HasMore)
    {
        <div class="load-more-section">
            <button class="btn-load-more" id="loadMoreBtn" data-page="@(Model.CurrentPage + 1)" data-type-id="@Model.TypeProductId">
                <i class="fas fa-chevron-down"></i>
                Xem thêm sản phẩm
            </button>
            <div class="loading-spinner" id="loadingSpinner" style="display: none;">
                <i class="fas fa-spinner fa-spin"></i> Đang tải...
            </div>
        </div>
    }
</div>

<script src="~/Scripts/self/cusstom.js"></script>
<script src="~/Scripts/self/product_filter.js"></script>